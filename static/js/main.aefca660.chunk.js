(this["webpackJsonpstream-racing-wheel"]=this["webpackJsonpstream-racing-wheel"]||[]).push([[0],{125:function(t,e,n){"use strict";n.r(e);var a,r=n(0),o=n.n(r),i=n(48),s=n.n(i),c=n(1),u=n(2),h=n(4),l=n(3),f=n(8),d=n(5),p=n(18),m=n(11),g=n.n(m),b={},v={},y={},x={},O=0,w={},j={},E="-";function k(t,e,n){var a;for(e=e.split(E),a=0;a<e.length-1;a++)t=t[e[a]];return t[e[a]]=n,e[0]}b.delimiter=function(t){E=t},b.get=function(t){var e;try{e=function(t,e){var n;for(e=e.split(E),n=0;n<e.length-1;n++)t=t[e[n]];return t[e[n]]}(v,t)}catch(n){throw new Error("[flatiron.get] ERROR: Key '"+t+"' not valid.")}return e},b.copy=function(t){var e=b.get(t);return g()(e)},b.set=function(t,e){var n=t;try{n=k(v,t,e)}catch(a){throw new Error("[flatiron.set] ERROR: Key '"+t+"' not valid.")}b._notifyHistory(n,v[n]),b._notifyComponents(n,v[n]),b._notifySubscribers(n,v[n]),n!==t?(b._notifyComponents(t,e),b._notifySubscribers(t,e)):b._notifyChildren(n)},b.setWithObj=function(t){for(var e in t){var n=e,a=t[e],r=n;try{r=k(v,n,a)}catch(o){throw new Error("[flatiron.set] ERROR: Key '"+n+"' not valid.")}b._notifyHistory(r,v[r]),b._notifyComponents(r,v[r]),b._notifySubscribers(r,v[r]),r!==n?(b._notifyComponents(n,a),b._notifySubscribers(n,a)):b._notifyChildren(r)}},b.subscribe=function(t,e){if(!(e instanceof Function))throw new Error("[flatiron.subscribe] ERROR: callback must be a function.");a||(a={}),a[t]||(a[t]=[]),a[t].push(e)},b.undo=function(t){if(!(t in j))throw new Error("[flatiron.undo] ERROR: Key '"+t+"' does not have historical state");var e=w[t]-2;return e<0&&(e=0),w[t]=e+1,b._setHistory(t,g()(j[t][e])),j[t][e]},b.redo=function(t){if(!(t in j))throw new Error("[flatiron.redo] ERROR: Key '"+t+"' does not have historical state");var e=w[t];return e>=j[t].length&&(e=j[t].length-1),w[t]=e+1,b._setHistory(t,g()(j[t][e])),j[t][e]},b.historical=function(t){j[t]=[],w[t]=0},b.connect=function(t,e,n){return function(a){return function(r){function i(t){var n;return Object(c.a)(this,i),(n=Object(h.a)(this,Object(l.a)(i).call(this,t))).watched={},n.onCustomWatched=null,n._flatironid=O++,e instanceof Function&&(n.onCustomWatched=e),n.state=n.processWatched(!0),n}return Object(d.a)(i,r),Object(u.a)(i,[{key:"componentWillUnmount",value:function(){b._unwatch(this.watched,this)}},{key:"processWatched",value:function(e){this.onCustomWatched&&(function(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1}(t,t=this.onCustomWatched(Object(p.a)({},this.props,{},this.state)))||(b._unwatch(this.watched,this),this.watched={}));if(!Array.isArray(t))throw new Error("[flatiron.ProcessWatched] ERROR: parameter watchList '"+typeof t+"' must return array of strings.");var n={};for(var a in t){var r=t[a];if(!(r in this.watched)&&(b._watch(r,this),this.watched[r]=!0,e)){var o=this.onNotify(r,b.copy(r),e);Object.assign(n,o)}}return n}},{key:"onNotify",value:function(t,e,a){var r={};if(r[t]=e,n instanceof Function){var o=n(t,e,Object.assign({},v),Object(p.a)({},this.props,{},this.state));Object.assign(r,o)}return a||this.setState(r),r}},{key:"render",value:function(){return o.a.createElement(a,Object(p.a)({},this.state,{},this.props),this.props.children)}}]),i}(o.a.Component)}},b._setHistory=function(t,e){var n=k(v,t,e);b._notifyComponents(t,e),b._notifySubscribers(t,e),b._notifyChildren(n)},b._notifyChildren=function(t){if(Array.isArray(v[t])||v[t]instanceof Object)for(var e in x[t]){var n=b.get(e);b._notifyComponents(e,n),b._notifySubscribers(e,n)}},b._notifyHistory=function(t,e){if(t in j){e=g()(e);var n=w[t];n==j[t].length?(j[t].push(e),w[t]=j[t].length):(j[t]=j[t].slice(0,n),j[t][n]=e,w[t]=n+1)}},b._notifyComponents=function(t,e){if(t in y)for(var n in y[t])y[t][n].onNotify(t,e)},b._notifySubscribers=function(t,e){if(a){for(var n in a["*"])a["*"][n](t,e);for(var r in a[t])a[t][r](t,e)}},b._watch=function(t,e){y[t]||(y[t]={}),y[t][e._flatironid]=e;var n=t.indexOf(E);if(n>-1){var a=t.substring(0,n);x[a]||(x[a]={}),x[a][t]=!0}},b._unwatch=function(t,e){for(var n in t)delete y[n][e._flatironid]};for(var C=b,_=function(t){function e(){return Object(c.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t={transform:"rotate("+900*this.props.rotation+"deg)"};return o.a.createElement("img",{style:t,src:"g920/wheel.png"})}}]),e}(r.Component),G=C.connect([],(function(t){return["axes-"+t.axis]}),(function(t,e,n,a){return{rotation:e}}))(_),R=function(t){function e(){return Object(c.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.props.downAmount*this.props.value*-1,e={width:"70px",position:"absolute",top:this.props.top+"px",left:this.props.left+"px",transform:"translateY("+t+"px)"};return o.a.createElement("img",{style:e,src:this.props.src})}}]),e}(r.Component),Y=C.connect([],(function(t){return["axes-"+t.axis]}),(function(t,e,n,a){return{value:e}}))(R),S=function(t){function e(){return Object(c.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(Y,{top:-20,left:290,downAmount:50,axis:1,src:"g920/gas.png"}),o.a.createElement(Y,{top:-10,left:160,downAmount:50,axis:2,src:"g920/brake.png"}),o.a.createElement(Y,{top:-10,left:40,downAmount:50,axis:5,src:"g920/clutch.png"}),o.a.createElement("img",{style:{width:"400px"},src:"g920/pedals.png"}))}}]),e}(r.Component),L=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(h.a)(this,Object(l.a)(e).call(this,t))).halfGrid=n.props.gridSize/2,n.halfGridY=n.props.gridSize/2.2,n.moveX=0,n.moveY=0,n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t="100ms";switch(this.props.gear){case-1:t="500ms",this.moveX=0,this.moveY=0;break;case 0:this.moveX=this.halfGrid,this.moveY=this.halfGridY;break;case 1:this.moveX=-this.halfGrid,this.moveY=-this.halfGridY;break;case 2:this.moveX=-this.halfGrid,this.moveY=this.halfGridY;break;case 3:this.moveX=0,this.moveY=-this.halfGridY;break;case 4:this.moveX=0,this.moveY=this.halfGridY;break;case 5:this.moveX=this.halfGrid,this.moveY=-this.halfGridY;break;case 6:this.moveX=this.halfGrid,this.moveY=this.halfGridY}var e={width:"150px","z-index":"999",position:"absolute",top:this.props.top+"px",left:this.props.left+"px",transition:"all "+t,transform:"translate("+this.moveX+"px, "+this.moveY+"px)"},n={backgroundColor:"red",width:"10px",height:"20px","z-index":"999",position:"absolute",top:"0px",left:"0px",display:"none"};return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{style:n}),o.a.createElement("img",{style:e,src:"g920/shifter.png"}))}}]),e}(r.Component),P=C.connect([],(function(t){return["buttons-"+t.gear1,"buttons-"+t.gear2,"buttons-"+t.gear3,"buttons-"+t.gear4,"buttons-"+t.gear5,"buttons-"+t.gear6,"buttons-"+t.reverse]}),(function(t,e,n,a){var r=a.gear||-1,o=a.gearButton||-1;if(e.pressed)switch(t){case"buttons-"+a.gear1:r=1,o=a.gear1;break;case"buttons-"+a.gear2:r=2,o=a.gear2;break;case"buttons-"+a.gear3:r=3,o=a.gear3;break;case"buttons-"+a.gear4:r=4,o=a.gear4;break;case"buttons-"+a.gear5:r=5,o=a.gear5;break;case"buttons-"+a.gear6:r=6,o=a.gear6;break;case"buttons-"+a.reverse:r=0,o=a.reverse;break;default:r=-1}else"buttons-"+a.gearButton==t&&(r=-1);return{gear:r,gearButton:o}}))(L),W=function(t){function e(){return Object(c.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(P,{top:70,left:50,gridSize:150,gear1:12,gear2:13,gear3:14,gear4:15,gear5:16,gear6:17,reverse:11}),o.a.createElement("img",{width:"250px",src:"g920/shifter-base.png"}))}}]),e}(r.Component),X=C.connect([],(function(t){return["buttons-"+t.axis]}),(function(t,e,n,a){return{value:e}}))(W),A=[],I=[],H=0;H<20;H++)A.push({pressed:!1,touched:!1,value:0}),I.push(0);C.set("buttons",A),C.set("axes",I);var z=function(t){function e(t){var n;Object(c.a)(this,e),(n=Object(h.a)(this,Object(l.a)(e).call(this,t))).gamePads={},n.start=0,n.a=0,n.b=0,n.gamePadIndex=-1,n.state={gameLoopStarted:!1},n.gameLoop=n.gameLoop.bind(Object(f.a)(n)),n.onGamepadConnected=n.onGamepadConnected.bind(Object(f.a)(n));Object(f.a)(n);return window.addEventListener("gamepadconnected",n.onGamepadConnected),n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"onGamepadConnected",value:function(t){var e=navigator.getGamepads()[t.gamepad.index];console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.index,e.id,e.buttons.length,e.axes.length),this.gamePads[e.index]=e,this.setState({gamePads:this.gamePads}),e.id.toLowerCase().indexOf("wheel")>-1&&this.changeGamepad(e.index)}},{key:"onChange",value:function(t){this.changeGamepad(t.target.value)}},{key:"changeGamepad",value:function(t){console.log(t),this.gamePadIndex=t,this.setState({gamepadIndex:t,gameLoopStarted:!0}),this.gameLoop()}},{key:"render",value:function(){var t=this,e=Object.values(this.gamePads).map((function(e){var n=e.index==t.gamePadIndex;return o.a.createElement("option",{selected:n,value:e.index},e.id)}));return o.a.createElement("div",{style:{paddingLeft:"50px",backgroundColor:"#133a4d"}},o.a.createElement("select",{name:"gamepadSelection",onChange:function(e){t.onChange(e)}},e),o.a.createElement("br",null),o.a.createElement("div",{style:{position:"relative",top:"20px"}},o.a.createElement(G,{axis:0})),o.a.createElement("div",{style:{position:"relative",top:"-300px",left:"500px",marginLeft:"50px"}},o.a.createElement(X,null)),o.a.createElement("div",{style:{position:"relative",top:"-170px",left:"30px",marginLeft:"50px"}},o.a.createElement(S,null)))}},{key:"buttonPressed",value:function(t){return"object"==typeof t?t.pressed:1==t}},{key:"gameLoop",value:function(){if(-1!=this.gamePadIndex){for(var t=navigator.getGamepads()[this.gamePadIndex],e=[],n=0;n<t.buttons.length;n++){var a=t.buttons[n],r={pressed:a.pressed,touched:a.touched,value:a.value};e.push(r)}for(var o=[],i=0;i<t.axes.length;i++){var s=t.axes[i];o.push(s)}C.set("buttons",e),C.set("axes",o),this.start=requestAnimationFrame(this.gameLoop)}}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},49:function(t,e,n){t.exports=n(125)}},[[49,1,2]]]);
//# sourceMappingURL=main.aefca660.chunk.js.map